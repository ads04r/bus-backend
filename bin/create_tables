#!/usr/bin/php -q
<?php

include_once(dirname(dirname(__file__)) . "/lib/bootstrap.php");

$db = new mysqli($cfg['database']['host'], $cfg['database']['username'], $cfg['database']['password'], $cfg['database']['database']);

$db->query("CREATE TABLE IF NOT EXISTS `fhrsplaces` (  `id` varchar(16) NOT NULL,  `label` varchar(128) NOT NULL,  `latitude` double NOT NULL DEFAULT '0',  `longitude` double NOT NULL DEFAULT '0',  `address` varchar(512) NOT NULL,  `postcode` varchar(16) NOT NULL,  PRIMARY KEY (`id`),  KEY `label` (`label`),  KEY `latitude` (`latitude`),  KEY `longitude` (`longitude`),  KEY `postcode` (`postcode`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `journeypattern` (  `id` varchar(32) NOT NULL,  `direction` varchar(16) NOT NULL,  `route` varchar(32) NOT NULL,  `service` varchar(32) NOT NULL,  PRIMARY KEY (`id`),  KEY `direction` (`direction`),  KEY `route` (`route`),  KEY `service` (`service`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `journeypatternsection` (  `id` varchar(32) NOT NULL,  `journeypattern` varchar(32) NOT NULL,  PRIMARY KEY (`id`),  KEY `journeypattern` (`journeypattern`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `journeypatterntiminglink` (  `id` varchar(32) NOT NULL,  `journeypatternsection` varchar(32) NOT NULL,  `routelink` varchar(32) NOT NULL,  `runtime` int(11) NOT NULL,  `waittime` int(11) NOT NULL,  `from` varchar(16) NOT NULL,  `to` varchar(16) NOT NULL,  `fromseq` smallint(6) NOT NULL,  `toseq` smallint(6) NOT NULL,  `fromactivity` varchar(32) NOT NULL,  `fromtimingstatus` varchar(8) NOT NULL,  `toactivity` varchar(32) NOT NULL,  `totimingstatus` varchar(8) NOT NULL,  PRIMARY KEY (`id`),  KEY `journeypatternsection` (`journeypatternsection`),  KEY `routelink` (`routelink`),  KEY `from` (`from`),  KEY `to` (`to`),  KEY `fromseq` (`fromseq`),  KEY `toseq` (`toseq`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `journeyroutes` (  `journeypattern` varchar(32) NOT NULL,  `routeid` varchar(32) NOT NULL,  `direction` varchar(16) NOT NULL,  `from` varchar(16) NOT NULL,  `to` varchar(16) NOT NULL,  `routenumber` varchar(8) NOT NULL,  `operator` varchar(32) NOT NULL,  `description` varchar(512) NOT NULL,  PRIMARY KEY (`journeypattern`),  KEY `routeid` (`routeid`),  KEY `direction` (`direction`),  KEY `routenumber` (`routenumber`),  KEY `operator` (`operator`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `journeyschedule` (  `journeypattern` varchar(32) NOT NULL,  `from` varchar(16) NOT NULL,  `to` varchar(16) NOT NULL,  `fromactivity` varchar(32) NOT NULL,  `toactivity` varchar(32) NOT NULL,  `fromtimingstatus` varchar(8) NOT NULL,  `totimingstatus` varchar(8) NOT NULL,  `runtime` int(11) NOT NULL,  `waittime` int(11) NOT NULL,  `fromseq` smallint(6) NOT NULL,  `toseq` smallint(6) NOT NULL,  PRIMARY KEY (`journeypattern`,`from`,`to`),  KEY `journeypattern` (`journeypattern`),  KEY `from` (`from`),  KEY `to` (`to`),  KEY `runtime` (`runtime`),  KEY `fromseq` (`fromseq`),  KEY `toseq` (`toseq`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `lines` (  `id` varchar(32) NOT NULL,  `name` varchar(8) NOT NULL,  `operator` varchar(32) NOT NULL,  PRIMARY KEY (`id`),  KEY `name` (`name`),  KEY `operator` (`operator`),  KEY `name_operator` (`name`,`operator`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `localities` (  `id` varchar(16) NOT NULL,  `localityname` varchar(127) NOT NULL,  `parentlocalityname` varchar(127) NOT NULL,  `grandparentlocalityname` varchar(127) NOT NULL,  PRIMARY KEY (`id`),  KEY `localityname` (`localityname`),  KEY `parentlocalityname` (`parentlocalityname`),  KEY `grandparentlocalityname` (`grandparentlocalityname`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `operator` (  `id` varchar(32) NOT NULL,  `noc` varchar(32) NOT NULL,  `oc` varchar(32) NOT NULL,  `name` varchar(127) NOT NULL,  `licensename` varchar(127) NOT NULL,  `tradingname` varchar(127) NOT NULL,  PRIMARY KEY (`id`),  UNIQUE KEY `noc` (`noc`),  KEY `oc` (`oc`),  KEY `name` (`name`),  KEY `licensename` (`licensename`),  KEY `tradingname` (`tradingname`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `organisations` (  `id` varchar(63) NOT NULL,  `label` varchar(127) NOT NULL,  PRIMARY KEY (`id`),  KEY `label` (`label`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `organisation_dates` (  `id` bigint(20) NOT NULL AUTO_INCREMENT,  `description` text NOT NULL,  `organisation` varchar(63) NOT NULL DEFAULT '',  `start` datetime NOT NULL,  `end` datetime NOT NULL,  PRIMARY KEY (`id`),  KEY `start` (`start`),  KEY `end` (`end`),  KEY `organisation` (`organisation`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `placestops` (  `fhrsid` varchar(16) NOT NULL,  `stopid` varchar(16) NOT NULL,  `distance` int(11) NOT NULL,  PRIMARY KEY (`fhrsid`,`stopid`),  KEY `fhrsid` (`fhrsid`),  KEY `stopid` (`stopid`),  KEY `distance` (`distance`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `route` (  `id` varchar(32) NOT NULL,  `description` varchar(512) NOT NULL,  PRIMARY KEY (`id`),  KEY `description` (`description`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `routelink` (  `id` varchar(32) NOT NULL,  `routesection` varchar(32) NOT NULL,  `from` varchar(16) NOT NULL,  `to` varchar(16) NOT NULL,  `direction` varchar(16) NOT NULL,  PRIMARY KEY (`id`),  KEY `routesection` (`routesection`),  KEY `from` (`from`),  KEY `to` (`to`),  KEY `direction` (`direction`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `routelocality` (  `nptgid` varchar(16) NOT NULL,  `routeid` varchar(32) NOT NULL,  `operator` varchar(8) NOT NULL,  `service` varchar(8) NOT NULL,  PRIMARY KEY (`nptgid`,`routeid`),  KEY `nptgid` (`nptgid`),  KEY `routeid` (`routeid`),  KEY `operator` (`operator`),  KEY `service` (`service`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `routeschedule` (  `journeypattern` varchar(32) NOT NULL,  `operator` varchar(8) NOT NULL,  `service` varchar(8) NOT NULL,  `journeydate` datetime NOT NULL,  `routeid` varchar(32) NOT NULL,  PRIMARY KEY (`journeypattern`,`journeydate`),  KEY `operator` (`operator`),  KEY `service` (`service`),  KEY `journeydate` (`journeydate`),  KEY `routeid` (`routeid`),  KEY `journeypattern` (`journeypattern`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `routesection` (  `id` varchar(32) NOT NULL,  `route` varchar(32) NOT NULL,  PRIMARY KEY (`id`),  KEY `route` (`route`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `schedule` (  `id` bigint(20) NOT NULL AUTO_INCREMENT,  `journey_number` tinyint(4) NOT NULL,  `route` varchar(32) NOT NULL,  `service` varchar(8) NOT NULL,  `operator` varchar(16) NOT NULL,  `stop_id` varchar(32) NOT NULL,  `date` datetime NOT NULL,  `journey` varchar(64) NOT NULL,  `destination` text NOT NULL,  `origin` text NOT NULL,  `description` text NOT NULL,  `sequence` tinyint(4) NOT NULL,  `direction` varchar(16) NOT NULL,  PRIMARY KEY (`id`),  KEY `operator` (`operator`),  KEY `stop_id` (`stop_id`),  KEY `date` (`date`),  KEY `route` (`route`),  KEY `service` (`service`),  KEY `direction` (`direction`),  KEY `sequence` (`sequence`),  KEY `journey` (`journey`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `service` (  `id` varchar(32) NOT NULL,  `line` varchar(32) NOT NULL,  `startdate` date NOT NULL,  `enddate` date NOT NULL,  `operator` varchar(32) NOT NULL,  `description` text NOT NULL,  `origin` varchar(127) NOT NULL,  `destination` varchar(127) NOT NULL,  PRIMARY KEY (`id`),  KEY `line` (`line`),  KEY `startdate` (`startdate`),  KEY `enddate` (`enddate`),  KEY `operator` (`operator`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `stops` (  `atcocode` varchar(16) NOT NULL,  `naptancode` varchar(16) DEFAULT NULL,  `commonname` varchar(127) NOT NULL DEFAULT '',  `shortcommonname` varchar(63) NOT NULL DEFAULT '',  `landmark` varchar(127) NOT NULL DEFAULT '',  `street` varchar(127) NOT NULL DEFAULT '',  `crossing` varchar(127) NOT NULL DEFAULT '',  `indicator` varchar(63) NOT NULL DEFAULT '',  `bearing` varchar(3) NOT NULL DEFAULT '',  `nptglocalitycode` varchar(16) NOT NULL DEFAULT '',  `latitude` double NOT NULL DEFAULT '0',  `longitude` double NOT NULL DEFAULT '0',  `stoptype` varchar(16) NOT NULL DEFAULT '',  `busstoptype` varchar(16) NOT NULL DEFAULT '',  `timingstatus` varchar(16) NOT NULL DEFAULT '',  `defaultwaittime` int(11) NOT NULL DEFAULT '0',  `status` varchar(16) NOT NULL DEFAULT '',  `notes` text NOT NULL,  PRIMARY KEY (`atcocode`),  UNIQUE KEY `naptancode` (`naptancode`),  KEY `commonname` (`commonname`),  KEY `nptglocalitycode` (`nptglocalitycode`),  KEY `latitude` (`latitude`),  KEY `longitude` (`longitude`),  KEY `shortcommonname` (`shortcommonname`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `vehiclejourney` (  `id` varchar(32) NOT NULL,  `departuretime` time NOT NULL,  `service` varchar(32) NOT NULL,  `line` varchar(32) NOT NULL,  `journeypattern` varchar(32) NOT NULL,  `profile` text NOT NULL,  PRIMARY KEY (`id`),  KEY `departuretime` (`departuretime`),  KEY `service` (`service`),  KEY `line` (`line`),  KEY `journeypattern` (`journeypattern`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `vehicleschedule` (  `id` varchar(32) NOT NULL,  `journeypattern` varchar(32) NOT NULL,  `service_number` varchar(8) NOT NULL,  `departuretime` time NOT NULL,  `direction` varchar(16) NOT NULL,  `startdate` date NOT NULL,  `enddate` date NOT NULL,  `noc` varchar(32) NOT NULL,  `operator` varchar(127) NOT NULL,  `origin` varchar(127) NOT NULL,  `destination` varchar(127) NOT NULL,  `description` text NOT NULL,  `profile` text NOT NULL,  PRIMARY KEY (`id`),  KEY `journeypattern` (`journeypattern`),  KEY `service_number` (`service_number`),  KEY `direction` (`direction`),  KEY `noc` (`noc`),  KEY `startdate` (`startdate`),  KEY `enddate` (`enddate`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `postcodes` (  `postcode` varchar(10) NOT NULL,  `latitude` double NOT NULL DEFAULT '0',  `longitude` double NOT NULL DEFAULT '0',  PRIMARY KEY (`postcode`),  KEY `latitude` (`latitude`),  KEY `longitude` (`longitude`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
$db->query("CREATE TABLE IF NOT EXISTS `postcodestops` ( `postcode` VARCHAR(8) NOT NULL, `stopid` VARCHAR(16) NOT NULL, `distance` INT NOT NULL, PRIMARY KEY (`postcode`, `stopid`), INDEX `distance` (`distance`), INDEX `stopid` (`stopid`), INDEX `postcode` (`postcode`)) COLLATE='latin1_swedish_ci' ENGINE=MyISAM;");
$db->query("CREATE TABLE IF NOT EXISTS `stoppolylinelink` (  `from` varchar(16) NOT NULL,  `to` varchar(16) NOT NULL,  `polyline` text NOT NULL,  PRIMARY KEY (`from`, `to`), KEY `from` (`from`),  KEY `to` (`to`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;");
